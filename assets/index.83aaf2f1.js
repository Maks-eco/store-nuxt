import{u as M}from"./counter.6205bad9.js";import{r as I,m as G,n as q,q as j,x as J,y as K,i as v,z as Q,A as R,f as w,s as N,B as F,h as z,o as m,c as b,a as f,F as P,l as A,C as S,D as W,t as D,p as X,e as Y,_ as B,E as Z,k as O,b as V,g as ee,w as te,T as ae}from"./entry.5ca1cdd8.js";import{v as y,b as se}from"./index.821a9878.js";const ne=()=>null;function U(...d){const c=typeof d[d.length-1]=="string"?d.pop():void 0;typeof d[0]!="string"&&d.unshift(c);let[e,o,i={}]=d;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");i.server=i.server??!0,i.default=i.default??ne,i.lazy=i.lazy??!1,i.immediate=i.immediate??!0;const n=K(),_=()=>n.isHydrating?n.payload.data[e]:n.static.data[e],x=()=>_()!==void 0;n._asyncData[e]||(n._asyncData[e]={data:I(_()??i.default()),pending:I(!x()),error:G(n.payload._errors,e),status:I("idle")});const t={...n._asyncData[e]};t.refresh=t.execute=(s={})=>{if(n._asyncDataPromises[e]){if(s.dedupe===!1)return n._asyncDataPromises[e];n._asyncDataPromises[e].cancelled=!0}if((s._initial||n.isHydrating&&s._initial!==!1)&&x())return _();t.pending.value=!0,t.status.value="pending";const p=new Promise((l,h)=>{try{l(o(n))}catch(g){h(g)}}).then(l=>{if(p.cancelled)return n._asyncDataPromises[e];let h=l;i.transform&&(h=i.transform(l)),i.pick&&(h=re(h,i.pick)),t.data.value=h,t.error.value=null,t.status.value="success"}).catch(l=>{if(p.cancelled)return n._asyncDataPromises[e];t.error.value=l,t.data.value=v(i.default()),t.status.value="error"}).finally(()=>{p.cancelled||(t.pending.value=!1,n.payload.data[e]=t.data.value,t.error.value&&(n.payload._errors[e]=Q(t.error.value)),delete n._asyncDataPromises[e])});return n._asyncDataPromises[e]=p,n._asyncDataPromises[e]};const u=()=>t.refresh({_initial:!0}),r=i.server!==!1&&n.payload.serverRendered;{const s=R();if(s&&!s._nuxtOnBeforeMountCbs){s._nuxtOnBeforeMountCbs=[];const l=s._nuxtOnBeforeMountCbs;s&&(q(()=>{l.forEach(h=>{h()}),l.splice(0,l.length)}),j(()=>l.splice(0,l.length)))}r&&n.isHydrating&&x()?(t.pending.value=!1,t.status.value=t.error.value?"error":"success"):s&&(n.payload.serverRendered&&n.isHydrating||i.lazy)&&i.immediate?s._nuxtOnBeforeMountCbs.push(u):i.immediate&&u(),i.watch&&J(i.watch,()=>t.refresh());const p=n.hook("app:data:refresh",l=>{if(!l||l.includes(e))return t.refresh()});s&&j(p)}const a=Promise.resolve(n._asyncDataPromises[e]).then(()=>t);return Object.assign(a,t),a}function re(d,c){const e={};for(const o of c)e[o]=d[o];return e}const H=async(d,c,e)=>{let o=await $fetch(`https://api.github.com/repos/${d}/${c}/contents/${e}`),i=await $fetch(`https://api.github.com/repos/${d}/${c}/git/blobs/${o.sha}`);return i.content?JSON.parse(atob(i.content)):null},T=d=>(X("data-v-c7a342eb"),d=d(),Y(),d),ie={class:"list"},ce=T(()=>f("h2",{class:"header"},"Категории:",-1)),oe=["onClick"],ue={class:"title"},le=T(()=>f("hr",{class:"hr"},null,-1)),de=w({__name:"CategoryList",async setup(d){let c,e;const o={id:-1,title:"Все бренды",code:"brand_all",sort:"0",active:!1},i=M(),{currentBrand:n}=N(i);I(!1);const _=I(!1),x=r=>{var s,p;_.value=!1,n.value=r;const a=(s=t.value)==null?void 0:s.findIndex(l=>l.id===r);(p=t.value)==null||p.forEach(l=>(l.active=!1,l)),typeof a<"u"&&t.value&&(t.value[a].active=!0)},{data:t,error:u}=([c,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),c=await c,e(),c);return z(()=>{t.value&&(t.value=[o,...t.value],t.value=t.value.map(r=>(r.active=n.value===r.id,r)))}),(r,a)=>(m(),b("div",{class:S([{backgrd:_.value}]),onClick:a[2]||(a[2]=s=>_.value=!1)},[f("div",{class:S([{"container-inactive":!_.value},"container"]),onClick:a[1]||(a[1]=W(()=>{},["stop"]))},[f("div",ie,[ce,(m(!0),b(P,null,A(v(t),s=>(m(),b("div",{class:S([{"brand-active":s.active},"brand"]),key:s.id,onClick:p=>x(s.id)},[f("p",ue,D(s.title),1)],10,oe))),128))]),le,f("button",{class:"hide-categories",onClick:a[0]||(a[0]=s=>_.value=!_.value)}," Категории ")],2)],2))}});const _e=B(de,[["__scopeId","data-v-c7a342eb"]]),fe={key:0,class:"attr-container"},ve={class:"variant-line"},pe={class:"line-label"},he=["onClick"],me={key:1,class:"attr-container"},be=w({__name:"VariantsIcon",props:{item:{}},emits:["updateImage","variantSelected"],setup(d,{emit:c}){const e=d,o=I([]),i=()=>{var t,u,r,a;if(e.item.current_attributes&&((t=e.item)==null?void 0:t.current_attributes.length)===2){const s=(u=e.item)==null?void 0:u.current_attributes[0],p=(r=e.item)==null?void 0:r.current_attributes[1];(a=e.item.variants)==null||a.forEach(l=>{let h=0;if(l.attributes.forEach(g=>{(g.value_index===s.value_index||g.value_index===p.value_index)&&h++}),h===2){let g=[s.value_index,p.value_index];g.sort(($,C)=>$-C);const L={...l.product,attrIndexes:g};c("updateImage",L),c("variantSelected",!0)}})}},n=()=>{var t,u,r,a,s,p,l,h,g,L;if((t=e.item)!=null&&t.current_attributes){if(((u=e.item)==null?void 0:u.current_attributes.length)===0){(r=e.item.configurable_options)==null||r.forEach($=>{$.values.forEach(C=>{C.state=y.Unchecked})}),c("variantSelected",!1);return}if(((a=e.item)==null?void 0:a.current_attributes.length)===1){const $=(s=e.item)==null?void 0:s.current_attributes[0];(p=e.item.configurable_options)==null||p.forEach(C=>{C.attribute_code===$.code&&C.values.forEach(k=>{if(k.value_index===$.value_index){k.state=y.Checked;return}k.state=y.Unchecked}),C.attribute_code!==$.code&&C.values.forEach(k=>{o.value.forEach(E=>{k.state=y.Inactive,E.value_index===k.value_index&&(k.state=y.Unchecked)})})}),c("variantSelected",!1);return}if(((l=e.item)==null?void 0:l.current_attributes.length)===2){const $=(h=e.item)==null?void 0:h.current_attributes[0].value_index,C=(g=e.item)==null?void 0:g.current_attributes[1].value_index;(L=e.item.configurable_options)==null||L.forEach(k=>{k.values.forEach(E=>{if(E.value_index===$||E.value_index===C){E.state=y.Checked;return}E.state=y.Hidden})}),i();return}}},_=()=>{var t,u,r,a;if((t=e.item)!=null&&t.current_attributes&&((u=e.item)==null?void 0:u.current_attributes.length)===1){const s=(r=e.item)==null?void 0:r.current_attributes[0],p=[];(a=e.item.variants)==null||a.forEach(l=>{const h=l.attributes.filter(g=>g.value_index!==s.value_index);h.length===1&&p.push(h[0])}),o.value=[...p]}else o.value=[];n()},x=(t,u)=>{var a;(a=e.item)!=null&&a.current_attributes||(e.item.current_attributes=[]);const r=e.item.current_attributes.findIndex(s=>s.code===t);if(r>=0){if(e.item.current_attributes[r].value_index===u){e.item.current_attributes=e.item.current_attributes.filter(s=>s.code!==t),_();return}e.item.current_attributes[r]={code:t,value_index:u}}else e.item.current_attributes.push({code:t,value_index:u});_()};return z(()=>{n()}),(t,u)=>(m(),b(P,null,[t.item.type==="configurable"?(m(),b("div",fe,[(m(!0),b(P,null,A(t.item.configurable_options,r=>(m(),b("div",ve,[f("p",pe,D(r.label),1),(m(!0),b(P,null,A(r.values,a=>(m(),b("div",null,[f("div",{class:S(["var",{"var-checked":a.state===v(y).Checked,"var-unchecked":a.state===v(y).Unchecked,"var-inactive":a.state===v(y).Inactive,"var-hidden":a.state===v(y).Hidden,"var-inactive-line":a.state===v(y).Inactive}]),style:Z({backgroundColor:r.attribute_code==="color"?a.value:"gray"}),onClick:s=>{a.state!==v(y).Inactive&&a.state!==v(y).Hidden&&x(r.attribute_code,a.value_index)}},[f("p",null,D(r.attribute_code!=="color"?a.label:""),1)],14,he)]))),256))]))),256))])):O("",!0),t.item.type!=="configurable"?(m(),b("div",me)):O("",!0)],64))}});const ye=B(be,[["__scopeId","data-v-fe54b289"]]),ge={class:"container-item"},xe=["src"],Ce={class:"description"},$e={class:"title"},ke={class:"brand-title"},Ie={class:"price"},De={class:"btn-con"},Ee=w({__name:"ProductCard",props:{item:{},brandList:{}},setup(d){const c=d,e=M(),o=I(c.item),i=I(c.item.type==="simple"),n=u=>se.slice(0,-1)+u,_=u=>{if(c.brandList){const r=c.brandList.find(a=>a.id===u);return r==null?void 0:r.title}return""},x=u=>{i.value=u},t=u=>{o.value.image=u.image.slice(0,6)+"s"+u.image.slice(6),o.value.productFeature={...u}};return z(()=>{}),(u,r)=>{const a=ye;return m(),b("div",ge,[f("img",{class:"image",src:n(v(o).image),alt:""},null,8,xe),f("div",Ce,[f("div",$e,D(v(o).title),1),f("div",ke,D(_(v(o).brand)),1),f("div",Ie,"$"+D(v(o).regular_price.value.toFixed(2)),1)]),f("div",De,[f("button",{class:S(["button",{"button-inactive":!v(i)}]),onClick:r[0]||(r[0]=s=>{v(i)&&v(e).saveProduct(v(o))})},D(v(i)?"Добавить в корзину":"Выберите опции"),3)]),V(a,{item:v(o),onUpdateImage:t,onVariantSelected:x},null,8,["item"])])}}});const Pe=B(Ee,[["__scopeId","data-v-ff084684"]]),Se={class:"container"},Ve={key:0,class:"empty-list"},we=w({__name:"ProductList",async setup(d){let c,e;const o=I(null),i=M(),{currentBrand:n}=N(i),{data:_}=([c,e]=F(()=>U("products",async()=>H("fe-side","vue-test","assets/level3/products.json"))),c=await c,e(),c),{data:x}=([c,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),c=await c,e(),c);return ee(()=>{if(n.value){if(_.value&&n.value===-1){o.value=[..._.value];return}_.value&&(o.value=_.value.filter(t=>t.brand==n.value))}else _.value&&(o.value=[..._.value])}),(t,u)=>{var a;const r=Pe;return m(),b(P,null,[f("div",Se,[V(ae,{name:"list"},{default:te(()=>[(m(!0),b(P,null,A(o.value,s=>(m(),b("div",{key:s.id},[f("div",null,[V(r,{item:s,"brand-list":v(x)},null,8,["item","brand-list"])])]))),128))]),_:1})]),((a=o.value)==null?void 0:a.length)===0?(m(),b("h3",Ve,"Товары отсутствуют")):O("",!0)],64)}}});const Be=B(we,[["__scopeId","data-v-d07fa524"]]),Le={class:"container"},Ae={class:"sidebar"},Fe={class:"content"},Oe={class:"border"},Ue=w({__name:"index",setup(d){return(c,e)=>{const o=_e,i=Be;return m(),b("div",Le,[f("div",Ae,[V(o)]),f("div",Fe,[f("div",Oe,[V(i)])])])}}});const je=B(Ue,[["__scopeId","data-v-f1bda771"]]);export{je as default};
