import{u as M}from"./counter.c72d9f3d.js";import{r as $,m as G,n as q,q as j,x as J,y as K,i as p,z as Q,A as R,f as w,s as N,B as F,h as z,o as b,c as y,a as v,F as P,l as A,C as S,D as W,t as D,p as X,e as Y,_ as B,E as Z,k as O,b as V,g as ee,w as te,T as ae}from"./entry.97b1b0f2.js";import{v as g,b as se}from"./index.821a9878.js";const ne=()=>null;function U(..._){const i=typeof _[_.length-1]=="string"?_.pop():void 0;typeof _[0]!="string"&&_.unshift(i);let[e,o,a={}]=_;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof o!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??ne,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const r=K(),h=()=>r.isHydrating?r.payload.data[e]:r.static.data[e],m=()=>h()!==void 0;r._asyncData[e]||(r._asyncData[e]={data:$(h()??a.default()),pending:$(!m()),error:G(r.payload._errors,e),status:$("idle")});const t={...r._asyncData[e]};t.refresh=t.execute=(n={})=>{if(r._asyncDataPromises[e]){if(n.dedupe===!1)return r._asyncDataPromises[e];r._asyncDataPromises[e].cancelled=!0}if((n._initial||r.isHydrating&&n._initial!==!1)&&m())return h();t.pending.value=!0,t.status.value="pending";const d=new Promise((l,f)=>{try{l(o(r))}catch(x){f(x)}}).then(l=>{if(d.cancelled)return r._asyncDataPromises[e];let f=l;a.transform&&(f=a.transform(l)),a.pick&&(f=re(f,a.pick)),t.data.value=f,t.error.value=null,t.status.value="success"}).catch(l=>{if(d.cancelled)return r._asyncDataPromises[e];t.error.value=l,t.data.value=p(a.default()),t.status.value="error"}).finally(()=>{d.cancelled||(t.pending.value=!1,r.payload.data[e]=t.data.value,t.error.value&&(r.payload._errors[e]=Q(t.error.value)),delete r._asyncDataPromises[e])});return r._asyncDataPromises[e]=d,r._asyncDataPromises[e]};const c=()=>t.refresh({_initial:!0}),u=a.server!==!1&&r.payload.serverRendered;{const n=R();if(n&&!n._nuxtOnBeforeMountCbs){n._nuxtOnBeforeMountCbs=[];const l=n._nuxtOnBeforeMountCbs;n&&(q(()=>{l.forEach(f=>{f()}),l.splice(0,l.length)}),j(()=>l.splice(0,l.length)))}u&&r.isHydrating&&m()?(t.pending.value=!1,t.status.value=t.error.value?"error":"success"):n&&(r.payload.serverRendered&&r.isHydrating||a.lazy)&&a.immediate?n._nuxtOnBeforeMountCbs.push(c):a.immediate&&c(),a.watch&&J(a.watch,()=>t.refresh());const d=r.hook("app:data:refresh",l=>{if(!l||l.includes(e))return t.refresh()});n&&j(d)}const s=Promise.resolve(r._asyncDataPromises[e]).then(()=>t);return Object.assign(s,t),s}function re(_,i){const e={};for(const o of i)e[o]=_[o];return e}const H=async(_,i,e)=>{let o=await $fetch(`https://api.github.com/repos/${_}/${i}/contents/${e}`),a=await $fetch(`https://api.github.com/repos/${_}/${i}/git/blobs/${o.sha}`);return a.content?JSON.parse(atob(a.content)):null},T=_=>(X("data-v-b01ffed6"),_=_(),Y(),_),ie={class:"list"},ce=T(()=>v("h2",{class:"header"},"Категории:",-1)),oe=["onClick"],ue={class:"title"},le=T(()=>v("hr",{class:"hr"},null,-1)),de=w({__name:"CategoryList",async setup(_){let i,e;const o={id:-1,title:"Все бренды",code:"brand_all",sort:"0",active:!1},a=$(null),r=M(),{currentBrand:h}=N(r);$(!1);const m=$(!1),t=s=>{var d,l;m.value=!1,h.value=s;const n=(d=a.value)==null?void 0:d.findIndex(f=>f.id===s);(l=a.value)==null||l.forEach(f=>(f.active=!1,f)),typeof n<"u"&&a.value&&(a.value[n].active=!0)},{data:c,error:u}=([i,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),i=await i,e(),i);return z(()=>{a.value&&(c.value&&(a.value=[o,...c.value]),a.value=a.value.map(s=>(s.active=h.value===s.id,s)))}),(s,n)=>(b(),y("div",{class:S([{backgrd:m.value}]),onClick:n[2]||(n[2]=d=>m.value=!1)},[v("div",{class:S([{"container-inactive":!m.value},"container"]),onClick:n[1]||(n[1]=W(()=>{},["stop"]))},[v("div",ie,[ce,(b(!0),y(P,null,A(a.value,d=>(b(),y("div",{class:S([{"brand-active":d.active},"brand"]),key:d.id,onClick:l=>t(d.id)},[v("p",ue,D(d.title),1)],10,oe))),128))]),le,v("button",{class:"hide-categories",onClick:n[0]||(n[0]=d=>m.value=!m.value)}," Категории ")],2)],2))}});const _e=B(de,[["__scopeId","data-v-b01ffed6"]]),fe={key:0,class:"attr-container"},ve={class:"variant-line"},pe={class:"line-label"},he=["onClick"],me={key:1,class:"attr-container"},be=w({__name:"VariantsIcon",props:{item:{}},emits:["updateImage","variantSelected"],setup(_,{emit:i}){const e=_,o=$([]),a=()=>{var t,c,u,s;if(e.item.current_attributes&&((t=e.item)==null?void 0:t.current_attributes.length)===2){const n=(c=e.item)==null?void 0:c.current_attributes[0],d=(u=e.item)==null?void 0:u.current_attributes[1];(s=e.item.variants)==null||s.forEach(l=>{let f=0;if(l.attributes.forEach(x=>{(x.value_index===n.value_index||x.value_index===d.value_index)&&f++}),f===2){let x=[n.value_index,d.value_index];x.sort((k,C)=>k-C);const L={...l.product,attrIndexes:x};i("updateImage",L),i("variantSelected",!0)}})}},r=()=>{var t,c,u,s,n,d,l,f,x,L;if((t=e.item)!=null&&t.current_attributes){if(((c=e.item)==null?void 0:c.current_attributes.length)===0){(u=e.item.configurable_options)==null||u.forEach(k=>{k.values.forEach(C=>{C.state=g.Unchecked})}),i("variantSelected",!1);return}if(((s=e.item)==null?void 0:s.current_attributes.length)===1){const k=(n=e.item)==null?void 0:n.current_attributes[0];(d=e.item.configurable_options)==null||d.forEach(C=>{C.attribute_code===k.code&&C.values.forEach(I=>{if(I.value_index===k.value_index){I.state=g.Checked;return}I.state=g.Unchecked}),C.attribute_code!==k.code&&C.values.forEach(I=>{o.value.forEach(E=>{I.state=g.Inactive,E.value_index===I.value_index&&(I.state=g.Unchecked)})})}),i("variantSelected",!1);return}if(((l=e.item)==null?void 0:l.current_attributes.length)===2){const k=(f=e.item)==null?void 0:f.current_attributes[0].value_index,C=(x=e.item)==null?void 0:x.current_attributes[1].value_index;(L=e.item.configurable_options)==null||L.forEach(I=>{I.values.forEach(E=>{if(E.value_index===k||E.value_index===C){E.state=g.Checked;return}E.state=g.Hidden})}),a();return}}},h=()=>{var t,c,u,s;if((t=e.item)!=null&&t.current_attributes&&((c=e.item)==null?void 0:c.current_attributes.length)===1){const n=(u=e.item)==null?void 0:u.current_attributes[0],d=[];(s=e.item.variants)==null||s.forEach(l=>{const f=l.attributes.filter(x=>x.value_index!==n.value_index);f.length===1&&d.push(f[0])}),o.value=[...d]}else o.value=[];r()},m=(t,c)=>{var s;(s=e.item)!=null&&s.current_attributes||(e.item.current_attributes=[]);const u=e.item.current_attributes.findIndex(n=>n.code===t);if(u>=0){if(e.item.current_attributes[u].value_index===c){e.item.current_attributes=e.item.current_attributes.filter(n=>n.code!==t),h();return}e.item.current_attributes[u]={code:t,value_index:c}}else e.item.current_attributes.push({code:t,value_index:c});h()};return z(()=>{r()}),(t,c)=>(b(),y(P,null,[t.item.type==="configurable"?(b(),y("div",fe,[(b(!0),y(P,null,A(t.item.configurable_options,u=>(b(),y("div",ve,[v("p",pe,D(u.label),1),(b(!0),y(P,null,A(u.values,s=>(b(),y("div",null,[v("div",{class:S(["var",{"var-checked":s.state===p(g).Checked,"var-unchecked":s.state===p(g).Unchecked,"var-inactive":s.state===p(g).Inactive,"var-hidden":s.state===p(g).Hidden,"var-inactive-line":s.state===p(g).Inactive}]),style:Z({backgroundColor:u.attribute_code==="color"?s.value:"gray"}),onClick:n=>{s.state!==p(g).Inactive&&s.state!==p(g).Hidden&&m(u.attribute_code,s.value_index)}},[v("p",null,D(u.attribute_code!=="color"?s.label:""),1)],14,he)]))),256))]))),256))])):O("",!0),t.item.type!=="configurable"?(b(),y("div",me)):O("",!0)],64))}});const ye=B(be,[["__scopeId","data-v-fe54b289"]]),ge={class:"container-item"},xe=["src"],Ce={class:"description"},$e={class:"title"},ke={class:"brand-title"},Ie={class:"price"},De={class:"btn-con"},Ee=w({__name:"ProductCard",props:{item:{},brandList:{}},setup(_){const i=_,e=M(),o=$(i.item),a=$(i.item.type==="simple"),r=c=>se.slice(0,-1)+c,h=c=>{if(i.brandList){const u=i.brandList.find(s=>s.id===c);return u==null?void 0:u.title}return""},m=c=>{a.value=c},t=c=>{o.value.image=c.image.slice(0,6)+"s"+c.image.slice(6),o.value.productFeature={...c}};return z(()=>{}),(c,u)=>{const s=ye;return b(),y("div",ge,[v("img",{class:"image",src:r(p(o).image),alt:""},null,8,xe),v("div",Ce,[v("div",$e,D(p(o).title),1),v("div",ke,D(h(p(o).brand)),1),v("div",Ie,"$"+D(p(o).regular_price.value.toFixed(2)),1)]),v("div",De,[v("button",{class:S(["button",{"button-inactive":!p(a)}]),onClick:u[0]||(u[0]=n=>{p(a)&&p(e).saveProduct(p(o))})},D(p(a)?"Добавить в корзину":"Выберите опции"),3)]),V(s,{item:p(o),onUpdateImage:t,onVariantSelected:m},null,8,["item"])])}}});const Pe=B(Ee,[["__scopeId","data-v-ff084684"]]),Se={class:"container"},Ve={key:0,class:"empty-list"},we=w({__name:"ProductList",async setup(_){let i,e;const o=$(null),a=M(),{currentBrand:r}=N(a),{data:h}=([i,e]=F(()=>U("products",async()=>H("fe-side","vue-test","assets/level3/products.json"))),i=await i,e(),i),{data:m}=([i,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),i=await i,e(),i);return ee(()=>{if(r.value){if(h.value&&r.value===-1){o.value=[...h.value];return}h.value&&(o.value=h.value.filter(t=>t.brand==r.value))}else h.value&&(o.value=[...h.value])}),(t,c)=>{var s;const u=Pe;return b(),y(P,null,[v("div",Se,[V(ae,{name:"list"},{default:te(()=>[(b(!0),y(P,null,A(o.value,n=>(b(),y("div",{key:n.id},[v("div",null,[V(u,{item:n,"brand-list":p(m)},null,8,["item","brand-list"])])]))),128))]),_:1})]),((s=o.value)==null?void 0:s.length)===0?(b(),y("h3",Ve,"Товары отсутствуют")):O("",!0)],64)}}});const Be=B(we,[["__scopeId","data-v-d07fa524"]]),Le={class:"container"},Ae={class:"sidebar"},Fe={class:"content"},Oe={class:"border"},Ue=w({__name:"index",setup(_){return(i,e)=>{const o=_e,a=Be;return b(),y("div",Le,[v("div",Ae,[V(o)]),v("div",Fe,[v("div",Oe,[V(a)])])])}}});const je=B(Ue,[["__scopeId","data-v-f1bda771"]]);export{je as default};
