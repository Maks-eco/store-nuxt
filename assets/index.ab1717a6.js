import{u as M}from"./counter.f9636b17.js";import{r as $,m as q,n as J,q as j,x as K,y as Q,i as p,z as R,A as W,f as w,s as N,B as F,g as T,h as z,o as y,c as g,a as v,F as P,l as A,C as S,D as X,t as D,p as Y,e as Z,_ as B,E as ee,k as O,b as V,w as te,T as ae}from"./entry.bcb65336.js";import{v as x,b as se}from"./index.821a9878.js";const ne=()=>null;function U(..._){const o=typeof _[_.length-1]=="string"?_.pop():void 0;typeof _[0]!="string"&&_.unshift(o);let[e,u,a={}]=_;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");a.server=a.server??!0,a.default=a.default??ne,a.lazy=a.lazy??!1,a.immediate=a.immediate??!0;const s=Q(),h=()=>s.isHydrating?s.payload.data[e]:s.static.data[e],b=()=>h()!==void 0;s._asyncData[e]||(s._asyncData[e]={data:$(h()??a.default()),pending:$(!b()),error:q(s.payload._errors,e),status:$("idle")});const t={...s._asyncData[e]};t.refresh=t.execute=(n={})=>{if(s._asyncDataPromises[e]){if(n.dedupe===!1)return s._asyncDataPromises[e];s._asyncDataPromises[e].cancelled=!0}if((n._initial||s.isHydrating&&n._initial!==!1)&&b())return h();t.pending.value=!0,t.status.value="pending";const d=new Promise((i,f)=>{try{i(u(s))}catch(m){f(m)}}).then(i=>{if(d.cancelled)return s._asyncDataPromises[e];let f=i;a.transform&&(f=a.transform(i)),a.pick&&(f=re(f,a.pick)),t.data.value=f,t.error.value=null,t.status.value="success"}).catch(i=>{if(d.cancelled)return s._asyncDataPromises[e];t.error.value=i,t.data.value=p(a.default()),t.status.value="error"}).finally(()=>{d.cancelled||(t.pending.value=!1,s.payload.data[e]=t.data.value,t.error.value&&(s.payload._errors[e]=R(t.error.value)),delete s._asyncDataPromises[e])});return s._asyncDataPromises[e]=d,s._asyncDataPromises[e]};const l=()=>t.refresh({_initial:!0}),c=a.server!==!1&&s.payload.serverRendered;{const n=W();if(n&&!n._nuxtOnBeforeMountCbs){n._nuxtOnBeforeMountCbs=[];const i=n._nuxtOnBeforeMountCbs;n&&(J(()=>{i.forEach(f=>{f()}),i.splice(0,i.length)}),j(()=>i.splice(0,i.length)))}c&&s.isHydrating&&b()?(t.pending.value=!1,t.status.value=t.error.value?"error":"success"):n&&(s.payload.serverRendered&&s.isHydrating||a.lazy)&&a.immediate?n._nuxtOnBeforeMountCbs.push(l):a.immediate&&l(),a.watch&&K(a.watch,()=>t.refresh());const d=s.hook("app:data:refresh",i=>{if(!i||i.includes(e))return t.refresh()});n&&j(d)}const r=Promise.resolve(s._asyncDataPromises[e]).then(()=>t);return Object.assign(r,t),r}function re(_,o){const e={};for(const u of o)e[u]=_[u];return e}const H=async(_,o,e)=>{let u=await $fetch(`https://api.github.com/repos/${_}/${o}/contents/${e}`),a=await $fetch(`https://api.github.com/repos/${_}/${o}/git/blobs/${u.sha}`);return a.content?JSON.parse(atob(a.content)):null},G=_=>(Y("data-v-bc802daf"),_=_(),Z(),_),ie={class:"list"},ce=G(()=>v("h2",{class:"header"},"Категории:",-1)),oe=["onClick"],ue={class:"title"},le=G(()=>v("hr",{class:"hr"},null,-1)),de=w({__name:"CategoryList",async setup(_){let o,e;const u={id:-1,title:"Все бренды",code:"brand_all",sort:"0",active:!1},a=$(null),s=M(),{currentBrand:h}=N(s);$(!1);const b=$(!1),t=n=>{var i,f;b.value=!1,h.value=n;const d=(i=a.value)==null?void 0:i.findIndex(m=>m.id===n);(f=a.value)==null||f.forEach(m=>(m.active=!1,m)),typeof d<"u"&&a.value&&(a.value[d].active=!0)},{pending:l,data:c,error:r}=([o,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),o=await o,e(),o);return T(()=>{l&&c.value&&(a.value=[u,...c.value])}),z(()=>{a.value&&(a.value=a.value.map(n=>(n.active=h.value===n.id,n)))}),(n,d)=>(y(),g("div",{class:S([{backgrd:b.value}]),onClick:d[2]||(d[2]=i=>b.value=!1)},[v("div",{class:S([{"container-inactive":!b.value},"container"]),onClick:d[1]||(d[1]=X(()=>{},["stop"]))},[v("div",ie,[ce,(y(!0),g(P,null,A(a.value,i=>(y(),g("div",{class:S([{"brand-active":i.active},"brand"]),key:i.id,onClick:f=>t(i.id)},[v("p",ue,D(i.title),1)],10,oe))),128))]),le,v("button",{class:"hide-categories",onClick:d[0]||(d[0]=i=>b.value=!b.value)}," Категории ")],2)],2))}});const _e=B(de,[["__scopeId","data-v-bc802daf"]]),fe={key:0,class:"attr-container"},ve={class:"variant-line"},pe={class:"line-label"},he=["onClick"],me={key:1,class:"attr-container"},be=w({__name:"VariantsIcon",props:{item:{}},emits:["updateImage","variantSelected"],setup(_,{emit:o}){const e=_,u=$([]),a=()=>{var t,l,c,r;if(e.item.current_attributes&&((t=e.item)==null?void 0:t.current_attributes.length)===2){const n=(l=e.item)==null?void 0:l.current_attributes[0],d=(c=e.item)==null?void 0:c.current_attributes[1];(r=e.item.variants)==null||r.forEach(i=>{let f=0;if(i.attributes.forEach(m=>{(m.value_index===n.value_index||m.value_index===d.value_index)&&f++}),f===2){let m=[n.value_index,d.value_index];m.sort((k,C)=>k-C);const L={...i.product,attrIndexes:m};o("updateImage",L),o("variantSelected",!0)}})}},s=()=>{var t,l,c,r,n,d,i,f,m,L;if((t=e.item)!=null&&t.current_attributes){if(((l=e.item)==null?void 0:l.current_attributes.length)===0){(c=e.item.configurable_options)==null||c.forEach(k=>{k.values.forEach(C=>{C.state=x.Unchecked})}),o("variantSelected",!1);return}if(((r=e.item)==null?void 0:r.current_attributes.length)===1){const k=(n=e.item)==null?void 0:n.current_attributes[0];(d=e.item.configurable_options)==null||d.forEach(C=>{C.attribute_code===k.code&&C.values.forEach(I=>{if(I.value_index===k.value_index){I.state=x.Checked;return}I.state=x.Unchecked}),C.attribute_code!==k.code&&C.values.forEach(I=>{u.value.forEach(E=>{I.state=x.Inactive,E.value_index===I.value_index&&(I.state=x.Unchecked)})})}),o("variantSelected",!1);return}if(((i=e.item)==null?void 0:i.current_attributes.length)===2){const k=(f=e.item)==null?void 0:f.current_attributes[0].value_index,C=(m=e.item)==null?void 0:m.current_attributes[1].value_index;(L=e.item.configurable_options)==null||L.forEach(I=>{I.values.forEach(E=>{if(E.value_index===k||E.value_index===C){E.state=x.Checked;return}E.state=x.Hidden})}),a();return}}},h=()=>{var t,l,c,r;if((t=e.item)!=null&&t.current_attributes&&((l=e.item)==null?void 0:l.current_attributes.length)===1){const n=(c=e.item)==null?void 0:c.current_attributes[0],d=[];(r=e.item.variants)==null||r.forEach(i=>{const f=i.attributes.filter(m=>m.value_index!==n.value_index);f.length===1&&d.push(f[0])}),u.value=[...d]}else u.value=[];s()},b=(t,l)=>{var r;(r=e.item)!=null&&r.current_attributes||(e.item.current_attributes=[]);const c=e.item.current_attributes.findIndex(n=>n.code===t);if(c>=0){if(e.item.current_attributes[c].value_index===l){e.item.current_attributes=e.item.current_attributes.filter(n=>n.code!==t),h();return}e.item.current_attributes[c]={code:t,value_index:l}}else e.item.current_attributes.push({code:t,value_index:l});h()};return z(()=>{s()}),(t,l)=>(y(),g(P,null,[t.item.type==="configurable"?(y(),g("div",fe,[(y(!0),g(P,null,A(t.item.configurable_options,c=>(y(),g("div",ve,[v("p",pe,D(c.label),1),(y(!0),g(P,null,A(c.values,r=>(y(),g("div",null,[v("div",{class:S(["var",{"var-checked":r.state===p(x).Checked,"var-unchecked":r.state===p(x).Unchecked,"var-inactive":r.state===p(x).Inactive,"var-hidden":r.state===p(x).Hidden,"var-inactive-line":r.state===p(x).Inactive}]),style:ee({backgroundColor:c.attribute_code==="color"?r.value:"gray"}),onClick:n=>{r.state!==p(x).Inactive&&r.state!==p(x).Hidden&&b(c.attribute_code,r.value_index)}},[v("p",null,D(c.attribute_code!=="color"?r.label:""),1)],14,he)]))),256))]))),256))])):O("",!0),t.item.type!=="configurable"?(y(),g("div",me)):O("",!0)],64))}});const ye=B(be,[["__scopeId","data-v-fe54b289"]]),ge={class:"container-item"},xe=["src"],Ce={class:"description"},$e={class:"title"},ke={class:"brand-title"},Ie={class:"price"},De={class:"btn-con"},Ee=w({__name:"ProductCard",props:{item:{},brandList:{}},setup(_){const o=_,e=M(),u=$(o.item),a=$(o.item.type==="simple"),s=l=>se.slice(0,-1)+l,h=l=>{if(o.brandList){const c=o.brandList.find(r=>r.id===l);return c==null?void 0:c.title}return""},b=l=>{a.value=l},t=l=>{u.value.image=l.image.slice(0,6)+"s"+l.image.slice(6),u.value.productFeature={...l}};return z(()=>{}),(l,c)=>{const r=ye;return y(),g("div",ge,[v("img",{class:"image",src:s(p(u).image),alt:""},null,8,xe),v("div",Ce,[v("div",$e,D(p(u).title),1),v("div",ke,D(h(p(u).brand)),1),v("div",Ie,"$"+D(p(u).regular_price.value.toFixed(2)),1)]),v("div",De,[v("button",{class:S(["button",{"button-inactive":!p(a)}]),onClick:c[0]||(c[0]=n=>{p(a)&&p(e).saveProduct(p(u))})},D(p(a)?"Добавить в корзину":"Выберите опции"),3)]),V(r,{item:p(u),onUpdateImage:t,onVariantSelected:b},null,8,["item"])])}}});const Pe=B(Ee,[["__scopeId","data-v-ff084684"]]),Se={class:"container"},Ve={key:0,class:"empty-list"},we=w({__name:"ProductList",async setup(_){let o,e;const u=$(null),a=M(),{currentBrand:s}=N(a),{data:h}=([o,e]=F(()=>U("products",async()=>H("fe-side","vue-test","assets/level3/products.json"))),o=await o,e(),o),{data:b}=([o,e]=F(()=>U("brands",async()=>H("fe-side","vue-test","assets/brands.json"))),o=await o,e(),o);return T(()=>{if(s.value){if(h.value&&s.value===-1){u.value=[...h.value];return}h.value&&(u.value=h.value.filter(t=>t.brand==s.value))}else h.value&&(u.value=[...h.value])}),(t,l)=>{var r;const c=Pe;return y(),g(P,null,[v("div",Se,[V(ae,{name:"list"},{default:te(()=>[(y(!0),g(P,null,A(u.value,n=>(y(),g("div",{key:n.id},[v("div",null,[V(c,{item:n,"brand-list":p(b)},null,8,["item","brand-list"])])]))),128))]),_:1})]),((r=u.value)==null?void 0:r.length)===0?(y(),g("h3",Ve,"Товары отсутствуют")):O("",!0)],64)}}});const Be=B(we,[["__scopeId","data-v-d07fa524"]]),Le={class:"container"},Ae={class:"sidebar"},Fe={class:"content"},Oe={class:"border"},Ue=w({__name:"index",setup(_){return(o,e)=>{const u=_e,a=Be;return y(),g("div",Le,[v("div",Ae,[V(u)]),v("div",Fe,[v("div",Oe,[V(a)])])])}}});const je=B(Ue,[["__scopeId","data-v-f1bda771"]]);export{je as default};
